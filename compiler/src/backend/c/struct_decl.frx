import "std/libc.frx";
import "c.frx";
import "../../frontend/ast/struct_decl.frx";

extern struct FILE;

extern
{
    i32 fprintf(mut FILE* stream, char* format, ...);
}

export void transpile_struct_decl(Transpiler* transpiler,
    StructDecl* struct_decl)
{
    frx::assert(transpiler != nullptr);

    frx::assert(struct_decl != nullptr);

    StructSymbol* symbol = &struct_decl->symbol;
    char* name = symbol->name;

    if(transpiler->mode == TranspilerMode::STRUCT_DECL)
    {
        if(libc_strcmp(name, "va_list") != 0
            && libc_strcmp(name, "DIR") != 0)
        {
            fprintf(transpiler->file, "typedef struct %s %s;\n", name, name);
        }
    }
}
