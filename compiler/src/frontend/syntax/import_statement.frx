export struct ASTImportStmt
{
    Parser* imported_parser;
    char* filepath;
    b8 exported;
}

export ASTImportStmt* make_import_stmt(Arena* arena, Parser* imported_parser,
    char* filepath, b8 exported)
{
    assert(filepath != nullptr);

    ASTImportStmt* import_stmt = arena_alloc(arena, sizeof(ASTImportStmt));

    import_stmt->imported_parser = imported_parser;
    import_stmt->filepath = filepath;
    import_stmt->exported = exported;

    return import_stmt;
}

ASTImportStmt* parse_import_stmt(Parser* parser, b8 exported)
{
    parser_eat(parser, TOKEN_TYPE_KW_IMPORT);

    char* filepath = parser->token->identifier;

    parser_eat(parser, TOKEN_TYPE_STRING_LITERAL);

    Parser* imported_parser = parser_compile(parser, filepath);

    ASTImportStmt* import_stmt = make_import_stmt(&parser->arena,
        imported_parser, filepath, exported);

    parser_eat(parser, TOKEN_TYPE_SEMICOLON);

    return import_stmt;
}

export void print_import_stmt(ASTImportStmt* import_stmt, FILE* file,
    usize depth)
{
    assert(import_stmt != nullptr);

    assert(file != nullptr);

    print_ast_depth(file, depth);

    fprintf(file, "%s (%s)\n", ast_type_to_str(AST_TYPE_IMPORT_STMT),
        import_stmt->filepath);
}
