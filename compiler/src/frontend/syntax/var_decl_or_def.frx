export import "../ast/stmt.frx";
import "type_specifier.frx";
import "var_decl.frx";
import "var_def.frx";
import "../core/parser.frx";

export Stmt* var_decl_or_def_parse(Parser* parser, TypeSpecifier* type, b8 mutable)
{
    frx::assert(parser != nullptr);

    frx::assert(type != nullptr);

    char* name = parser->token->identifier;

    parser_eat(parser, TokenType::IDENTIFIER);

    type_specifier_parse_array_dimensions(parser, type);

    mut Stmt* stmt = nullptr;

    switch(parser->token->type)
    {
        case TokenType::SEMICOLON:
            {
                stmt = stmt_from_var_decl(&parser->arena,
                        var_decl_parse(parser, type, name, mutable));

                break;
            }
        case TokenType::EQ:
            {
                stmt = stmt_from_var_def(&parser->arena,
                        var_def_parse(parser, type, name, mutable));

                break;
            }
        default:
            {
                parser_panic(parser);

                break;
            }
    }

    return stmt;
}
